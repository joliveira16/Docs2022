<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Building a strategy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="">

    <link rel="stylesheet" id="theme_link" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/4.6.0/materia/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>

    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
    <link type="text/css" rel="stylesheet" href="/Teaching/content/navbar-fixed-left.css" />
    <link type="text/css" rel="stylesheet" href="/Teaching/content/fsdocs-default.css" />
    <link type="text/css" rel="stylesheet" href="/Teaching/content/fsdocs-custom.css" />
    <script type="text/javascript" src="/Teaching/content/fsdocs-tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <!-- END SEARCH BOX: this adds support for the search box -->
    
</head>

<body>
    <nav class="navbar navbar-expand-md navbar-light bg-secondary fixed-left" id="fsdocs-nav">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse navbar-nav-scroll" id="navbarsExampleDefault">
            <a href="/Teaching/"><img id="fsdocs-logo" src="/Teaching/img/logo.png" /></a>
            <!-- BEGIN SEARCH BOX: this adds support for the search box -->
            <div id="header">
                <div class="searchbox" id="fsdocs-searchbox">
                    <label for="search-by">
                        <i class="fas fa-search"></i>
                    </label>
                    <input data-search-input="" id="search-by" type="search" placeholder="Search..." />
                    <span data-search-clear="">
                        <i class="fas fa-times"></i>
                    </span>
                </div>
            </div>

            <!-- END SEARCH BOX: this adds support for the search box -->
            <ul class="navbar-nav">
                <li class="nav-header">Links</li>
                <li class="nav-item" id="fsdocs-license-link"><a class="nav-link" href="https://github.com/nhirschey/Teaching/blob/main/LICENSE.md">License</a></li>
                <li class="nav-item" id="fsdocs-repository-link"><a class="nav-link" href="https://github.com/nhirschey/Teaching">Source Repository</a></li>
                <li class="nav-header">
  Getting Started
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/install.html">
    Install Software
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/learn-fsharp.html">
    Learn F#
  </a>
</li>             
<li class="nav-header">
  Lectures
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/fundamentals.html">
    Fundamentals
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/portfolio-statistics.html">
    Basic Portfolio Statistics
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/VolatilityTiming.html">
    Volatility Timing
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/portfolio-returns.html">
    Portfolio Returns
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/PortfolioFormation-SimpleExample.html">
    Building a strategy
  </a>
</li>             
<li class="nav-header">
  Assignments
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/football-1-download-data.html">
    Webscraping HTML to CSV
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/football-tuples-and-records.html">
    Tuples and Records (with solutions)
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/football-collection-functions.html">
    Collection functions (with solutions)
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/football-plotting.html">
    Plotting (with solutions)
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/select-project-signal.html">
    Select Project Signals
  </a>
</li>             
<li class="nav-header">
  Practice Quizzes
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/quizzes/fundamentals-PracticeQuiz.html">
    Fundamentals
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/quizzes/volatilityTiming-PracticeQuiz.html">
    Volatility Timing Part 1
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/quizzes/volatilityTiming-PracticeQuiz-2.html">
    Volatility Timing Part 2
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/quizzes/Option-Match-Map-practiceQuiz.html">
    Option Match Map
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/quizzes/discriminatedUnion-practiceQuiz.html">
    Dicriminated Union
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/quizzes/portfolios-PracticeQuiz.html">
    Portfolios
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/quizzes/factors-practiceQuiz.html">
    Factors
  </a>
</li>             
<li class="nav-header">
  Other
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/Common.html">
    Common
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/Momentum-Class.html">
    Price momentum

  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/Portfolio.html">
    Portfolio
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/Teaching/YahooFinance.html">
    YahooFinance
  </a>
</li>
            </ul>
        </div>
    </nav>
    <div class="container">
        <div class="masthead">
            <h3 class="muted"><a href="/Teaching/">Teaching</a></h3>
        </div>
        <hr />
        <div class="container" id="fsdocs-content">
            
<p><a href="https://mybinder.org/v2/gh/nhirschey/teaching/gh-pages?filepath=PortfolioFormation-SimpleExample.ipynb"><img src="img/badge-binder.svg" alt="Binder" /></a>&emsp;
<a href="/Teaching//PortfolioFormation-SimpleExample.fsx"><img src="img/badge-script.svg" alt="Script" /></a>&emsp;
<a href="/Teaching//PortfolioFormation-SimpleExample.ipynb"><img src="img/badge-notebook.svg" alt="Notebook" /></a></p>
<h1><a name="Building-a-strategy" class="anchor" href="#Building-a-strategy">Building a strategy</a></h1>
<p>Our objective is to write code that will allow us to do something like</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="id">samplePeriod</span>
<span class="o">|&gt;</span> <span class="id">filterInvestmentUniverse</span>
<span class="o">|&gt;</span> <span class="id">constructSignals</span>
<span class="o">|&gt;</span> <span class="id">assignPortfolioWeights</span>
<span class="o">|&gt;</span> <span class="id">getPortfolioReturns</span>
</code></pre>
<p>Now let's dig in. This is a <em>relatively</em> basic version of a strategy to build intuition with what we're doing. It is simpler than working with real data. But we will next move to real data.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="pp">#r</span> <span class="s">&quot;nuget: FSharp.Stats&quot;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="id">Stats</span>
</code></pre>
<h2><a name="Workflow-for-using-quantitative-signals" class="anchor" href="#Workflow-for-using-quantitative-signals">Workflow for using quantitative signals</a></h2>
<p>How do we decide on the position weights for the different securities? An example workflow:</p>
<ol>
<li><strong>Define your investment universe.</strong> Your investment universe is the set of securities that you are considering for investment. An investment universe is typically a subset of securities grouped by some common characteristics: small-capitalization stocks, utility stocks, corporate bonds, firms listed on Euronext, etc.</li>
<li><strong>Get your signal for each security.</strong> The signal is some information that you believe can be used to predict returns or risk. It could be a stock tip from a friend, a stock analyst recommendation, something you read on reddit, revenue growth, ...</li>
<li><strong>Define a mapping from signals to portfolio weights.</strong></li>
</ol>
<p>Let's go through this step by step.</p>
<h2><a name="1-Investment-universe-modelling-a-security" class="anchor" href="#1-Investment-universe-modelling-a-security">1. Investment universe: modelling a security</a></h2>
<p>We're going to be forming portfolios consisting of weights on different securities. We need a way to identify those securities. Securities can have different identifiers. Stock exchanges use ticker symbols, but CUSIPs are commonly used by other entities (e.g., ratings agencies, regulators, etc.). Some data providers might also use their own custom identifier. For example, Bloomberg has their own "Bloomberg ticker" and CRSP uses PERMNOs. Thus, if we're trying to identify a security we can use tickers OR CUSIPs OR Bloomberg Tickers OR PERMNOs. How do we model this?</p>
<p>A good type for modelling "OR" relationships is a Discriminated Union. The pipe (<code>|</code>) symbol indicates an "or" relationship.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="rt">SecurityId</span> <span class="o">=</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="uc">Ticker</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="rt">string</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="uc">Cusip</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs5', 7)" onmouseover="showTip(event, 'fs5', 7)" class="rt">string</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="uc">Bloomberg</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs5', 9)" onmouseover="showTip(event, 'fs5', 9)" class="rt">string</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="uc">Permno</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="vt">int</span>


<span class="c">// Defining examples of these ids.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 12)" onmouseover="showTip(event, 'fs10', 12)" class="id">tickerExample</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 13)" onmouseover="showTip(event, 'fs4', 13)" class="uc">Ticker</span> <span class="s">&quot;KO&quot;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 14)" onmouseover="showTip(event, 'fs11', 14)" class="id">permnoExample</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs8', 15)" onmouseover="showTip(event, 'fs8', 15)" class="uc">Permno</span> <span class="n">1001</span>


<span class="c">// Deconstructing using pattern matching.</span>
<span class="c">// Think &quot;match what&#39;s on the left side of = to what&#39;s on the right side&quot;</span>
<span class="k">let</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs4', 16)" onmouseover="showTip(event, 'fs4', 16)" class="uc">Ticker</span> <span onmouseout="hideTip(event, 'fs12', 17)" onmouseover="showTip(event, 'fs12', 17)" class="id">deconTickerExample</span><span class="pn">)</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 18)" onmouseover="showTip(event, 'fs10', 18)" class="id">tickerExample</span>
<span onmouseout="hideTip(event, 'fs13', 19)" onmouseover="showTip(event, 'fs13', 19)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs12', 20)" onmouseover="showTip(event, 'fs12', 20)" class="id">deconTickerExample</span>

<span class="k">let</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs8', 21)" onmouseover="showTip(event, 'fs8', 21)" class="uc">Permno</span> <span onmouseout="hideTip(event, 'fs14', 22)" onmouseover="showTip(event, 'fs14', 22)" class="id">deconPermnoExample</span><span class="pn">)</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs11', 23)" onmouseover="showTip(event, 'fs11', 23)" class="id">permnoExample</span>
<span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%i</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs14', 25)" onmouseover="showTip(event, 'fs14', 25)" class="id">deconPermnoExample</span>

<span class="c">// Now we can define our investment universe.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 26)" onmouseover="showTip(event, 'fs15', 26)" class="id">investmentUniverse</span> <span class="o">=</span>
    <span class="pn">[</span><span class="k">for</span> <span onmouseout="hideTip(event, 'fs16', 27)" onmouseover="showTip(event, 'fs16', 27)" class="fn">tick</span> <span class="k">in</span> <span class="pn">[</span> <span class="s">&quot;AAPL&quot;</span><span class="pn">;</span> <span class="s">&quot;KO&quot;</span><span class="pn">;</span> <span class="s">&quot;GOOG&quot;</span><span class="pn">;</span><span class="s">&quot;DIS&quot;</span><span class="pn">;</span><span class="s">&quot;GME&quot;</span><span class="pn">]</span> <span class="k">do</span> 
        <span onmouseout="hideTip(event, 'fs4', 28)" onmouseover="showTip(event, 'fs4', 28)" class="uc">Ticker</span> <span onmouseout="hideTip(event, 'fs16', 29)" onmouseover="showTip(event, 'fs16', 29)" class="fn">tick</span> <span class="pn">]</span>
</code></pre>
<h2><a name="2-Signals" class="anchor" href="#2-Signals">2. Signals</a></h2>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 30)" onmouseover="showTip(event, 'fs17', 30)" class="id">signals</span> <span class="o">=</span>
    <span class="pn">[</span> <span onmouseout="hideTip(event, 'fs4', 31)" onmouseover="showTip(event, 'fs4', 31)" class="uc">Ticker</span> <span class="s">&quot;AAPL&quot;</span><span class="pn">,</span> <span class="n">2.0</span>
      <span onmouseout="hideTip(event, 'fs4', 32)" onmouseover="showTip(event, 'fs4', 32)" class="uc">Ticker</span> <span class="s">&quot;KO&quot;</span><span class="pn">,</span> <span class="o">-</span><span class="n">1.4</span>
      <span onmouseout="hideTip(event, 'fs4', 33)" onmouseover="showTip(event, 'fs4', 33)" class="uc">Ticker</span> <span class="s">&quot;GOOG&quot;</span><span class="pn">,</span> <span class="n">0.4</span> 
      <span onmouseout="hideTip(event, 'fs4', 34)" onmouseover="showTip(event, 'fs4', 34)" class="uc">Ticker</span> <span class="s">&quot;DIS&quot;</span><span class="pn">,</span> <span class="n">1.1</span> <span class="pn">]</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs18', 35)" onmouseover="showTip(event, 'fs18', 35)" class="fn">Map</span>
</code></pre>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs17', 36)" onmouseover="showTip(event, 'fs17', 36)" class="id">signals</span><span class="pn">[</span><span onmouseout="hideTip(event, 'fs4', 37)" onmouseover="showTip(event, 'fs4', 37)" class="uc">Ticker</span> <span class="s">&quot;AAPL&quot;</span><span class="pn">]</span>
</code></pre>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs18', 38)" onmouseover="showTip(event, 'fs18', 38)" class="m">Map</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs19', 39)" onmouseover="showTip(event, 'fs19', 39)" class="id">find</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs4', 40)" onmouseover="showTip(event, 'fs4', 40)" class="uc">Ticker</span> <span class="s">&quot;AAPL&quot;</span><span class="pn">)</span> <span onmouseout="hideTip(event, 'fs17', 41)" onmouseover="showTip(event, 'fs17', 41)" class="id">signals</span>
</code></pre>
<table class="pre"><tr><td><pre><code>2.0</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs18', 42)" onmouseover="showTip(event, 'fs18', 42)" class="m">Map</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 43)" onmouseover="showTip(event, 'fs20', 43)" class="id">tryFind</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs4', 44)" onmouseover="showTip(event, 'fs4', 44)" class="uc">Ticker</span> <span class="s">&quot;AAPL&quot;</span><span class="pn">)</span> <span onmouseout="hideTip(event, 'fs17', 45)" onmouseover="showTip(event, 'fs17', 45)" class="id">signals</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Some 2.0</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs18', 46)" onmouseover="showTip(event, 'fs18', 46)" class="m">Map</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 47)" onmouseover="showTip(event, 'fs20', 47)" class="id">tryFind</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs4', 48)" onmouseover="showTip(event, 'fs4', 48)" class="uc">Ticker</span> <span class="s">&quot;GME&quot;</span><span class="pn">)</span> <span onmouseout="hideTip(event, 'fs17', 49)" onmouseover="showTip(event, 'fs17', 49)" class="id">signals</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Real: 00:00:00.000, CPU: 00:00:00.000, GC gen0: 0, gen1: 0, gen2: 0
val it : float option = None</code></pre></td></tr></table>
<p>Now a function that gets the signal given a security id.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs21', 50)" onmouseover="showTip(event, 'fs21', 50)" class="fn">getSignal</span> <span onmouseout="hideTip(event, 'fs22', 51)" onmouseover="showTip(event, 'fs22', 51)" class="fn">id</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs18', 52)" onmouseover="showTip(event, 'fs18', 52)" class="m">Map</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 53)" onmouseover="showTip(event, 'fs20', 53)" class="id">tryFind</span> <span onmouseout="hideTip(event, 'fs22', 54)" onmouseover="showTip(event, 'fs22', 54)" class="fn">id</span> <span onmouseout="hideTip(event, 'fs17', 55)" onmouseover="showTip(event, 'fs17', 55)" class="id">signals</span>

<span onmouseout="hideTip(event, 'fs21', 56)" onmouseover="showTip(event, 'fs21', 56)" class="fn">getSignal</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs4', 57)" onmouseover="showTip(event, 'fs4', 57)" class="uc">Ticker</span> <span class="s">&quot;AAPL&quot;</span><span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs21', 58)" onmouseover="showTip(event, 'fs21', 58)" class="fn">getSignal</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs4', 59)" onmouseover="showTip(event, 'fs4', 59)" class="uc">Ticker</span> <span class="s">&quot;GOOG&quot;</span><span class="pn">)</span>
</code></pre>
<p>We can call this function on all signals in our investment universe.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// using a loop.</span>
<span class="pn">[</span> <span class="k">for</span> <span onmouseout="hideTip(event, 'fs23', 60)" onmouseover="showTip(event, 'fs23', 60)" class="fn">security</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs15', 61)" onmouseover="showTip(event, 'fs15', 61)" class="id">investmentUniverse</span> <span class="k">do</span>
    <span onmouseout="hideTip(event, 'fs23', 62)" onmouseover="showTip(event, 'fs23', 62)" class="fn">security</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs21', 63)" onmouseover="showTip(event, 'fs21', 63)" class="fn">getSignal</span> <span onmouseout="hideTip(event, 'fs23', 64)" onmouseover="showTip(event, 'fs23', 64)" class="fn">security</span> <span class="pn">]</span>

<span class="c">// same thing with List.map</span>
<span onmouseout="hideTip(event, 'fs15', 65)" onmouseover="showTip(event, 'fs15', 65)" class="id">investmentUniverse</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 66)" onmouseover="showTip(event, 'fs24', 66)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs25', 67)" onmouseover="showTip(event, 'fs25', 67)" class="id">map</span><span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs23', 68)" onmouseover="showTip(event, 'fs23', 68)" class="fn">security</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs23', 69)" onmouseover="showTip(event, 'fs23', 69)" class="fn">security</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs21', 70)" onmouseover="showTip(event, 'fs21', 70)" class="fn">getSignal</span> <span onmouseout="hideTip(event, 'fs23', 71)" onmouseover="showTip(event, 'fs23', 71)" class="fn">security</span><span class="pn">)</span>
</code></pre>
<p>Let's create a type to hold a security identifier and its signal.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs26', 72)" onmouseover="showTip(event, 'fs26', 72)" class="rt">SecuritySignal</span> <span class="o">=</span> 
    <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs27', 73)" onmouseover="showTip(event, 'fs27', 73)" class="prop">SecurityId</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs3', 74)" onmouseover="showTip(event, 'fs3', 74)" class="rt">SecurityId</span>
      <span onmouseout="hideTip(event, 'fs28', 75)" onmouseover="showTip(event, 'fs28', 75)" class="prop">Signal</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs29', 76)" onmouseover="showTip(event, 'fs29', 76)" class="vt">float</span> <span class="pn">}</span>
</code></pre>
<p>Now a function that gets the signal and puts it in the
<code>SecuritySignal</code> record type. It's possible that the security signal does not exist, so we'll use an option type to handle the fact that we might
find the signal and we might not.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs30', 77)" onmouseover="showTip(event, 'fs30', 77)" class="fn">getSecuritySignal</span> <span onmouseout="hideTip(event, 'fs23', 78)" onmouseover="showTip(event, 'fs23', 78)" class="fn">security</span> <span class="o">=</span>
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs18', 79)" onmouseover="showTip(event, 'fs18', 79)" class="m">Map</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 80)" onmouseover="showTip(event, 'fs20', 80)" class="id">tryFind</span> <span onmouseout="hideTip(event, 'fs23', 81)" onmouseover="showTip(event, 'fs23', 81)" class="fn">security</span> <span onmouseout="hideTip(event, 'fs17', 82)" onmouseover="showTip(event, 'fs17', 82)" class="id">signals</span> <span class="k">with</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs31', 83)" onmouseover="showTip(event, 'fs31', 83)" class="uc">None</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs31', 84)" onmouseover="showTip(event, 'fs31', 84)" class="uc">None</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs32', 85)" onmouseover="showTip(event, 'fs32', 85)" class="uc">Some</span> <span onmouseout="hideTip(event, 'fs33', 86)" onmouseover="showTip(event, 'fs33', 86)" class="fn">signal</span> <span class="k">-&gt;</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs34', 87)" onmouseover="showTip(event, 'fs34', 87)" class="fn">result</span> <span class="o">=</span> <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs3', 88)" onmouseover="showTip(event, 'fs3', 88)" class="prop">SecurityId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 89)" onmouseover="showTip(event, 'fs23', 89)" class="fn">security</span><span class="pn">;</span> <span onmouseout="hideTip(event, 'fs35', 90)" onmouseover="showTip(event, 'fs35', 90)" class="prop">Signal</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs33', 91)" onmouseover="showTip(event, 'fs33', 91)" class="fn">signal</span> <span class="pn">}</span>
        <span onmouseout="hideTip(event, 'fs32', 92)" onmouseover="showTip(event, 'fs32', 92)" class="uc">Some</span> <span onmouseout="hideTip(event, 'fs34', 93)" onmouseover="showTip(event, 'fs34', 93)" class="fn">result</span>
</code></pre>
<p>Here we can see that we retured something when there
was a signal and nothing if there was none.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs30', 94)" onmouseover="showTip(event, 'fs30', 94)" class="fn">getSecuritySignal</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs4', 95)" onmouseover="showTip(event, 'fs4', 95)" class="uc">Ticker</span> <span class="s">&quot;GME&quot;</span><span class="pn">)</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Real: 00:00:00.000, CPU: 00:00:00.000, GC gen0: 0, gen1: 0, gen2: 0
val it : SecuritySignal option = None</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs30', 96)" onmouseover="showTip(event, 'fs30', 96)" class="fn">getSecuritySignal</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs4', 97)" onmouseover="showTip(event, 'fs4', 97)" class="uc">Ticker</span> <span class="s">&quot;GOOG&quot;</span><span class="pn">)</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Real: 00:00:00.000, CPU: 00:00:00.000, GC gen0: 0, gen1: 0, gen2: 0
val it : SecuritySignal option = Some { SecurityId = Ticker "GOOG"
                                        Signal = 0.4 }</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">for</span> <span onmouseout="hideTip(event, 'fs23', 98)" onmouseover="showTip(event, 'fs23', 98)" class="fn">security</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs15', 99)" onmouseover="showTip(event, 'fs15', 99)" class="id">investmentUniverse</span> <span class="k">do</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 100)" onmouseover="showTip(event, 'fs36', 100)" class="fn">securitySignal</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs30', 101)" onmouseover="showTip(event, 'fs30', 101)" class="fn">getSecuritySignal</span> <span onmouseout="hideTip(event, 'fs23', 102)" onmouseover="showTip(event, 'fs23', 102)" class="fn">security</span>
    <span onmouseout="hideTip(event, 'fs13', 103)" onmouseover="showTip(event, 'fs13', 103)" class="fn">printfn</span> <span class="s">$&quot;{</span><span onmouseout="hideTip(event, 'fs36', 104)" onmouseover="showTip(event, 'fs36', 104)" class="fn">securitySignal</span><span class="s">}&quot;</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Some({ SecurityId = Ticker "AAPL"
  Signal = 2.0 })
Some({ SecurityId = Ticker "KO"
  Signal = -1.4 })
Some({ SecurityId = Ticker "GOOG"
  Signal = 0.4 })
Some({ SecurityId = Ticker "DIS"
  Signal = 1.1 })</code></pre></td></tr></table>
<p>This is equivalent but using a pipeline.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs15', 105)" onmouseover="showTip(event, 'fs15', 105)" class="id">investmentUniverse</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 106)" onmouseover="showTip(event, 'fs24', 106)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs25', 107)" onmouseover="showTip(event, 'fs25', 107)" class="id">map</span> <span onmouseout="hideTip(event, 'fs30', 108)" onmouseover="showTip(event, 'fs30', 108)" class="fn">getSecuritySignal</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 109)" onmouseover="showTip(event, 'fs24', 109)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs37', 110)" onmouseover="showTip(event, 'fs37', 110)" class="id">iter</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs13', 111)" onmouseover="showTip(event, 'fs13', 111)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%A</span><span class="s">&quot;</span><span class="pn">)</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Some { SecurityId = Ticker "AAPL"
       Signal = 2.0 }
Some { SecurityId = Ticker "KO"
       Signal = -1.4 }
Some { SecurityId = Ticker "GOOG"
       Signal = 0.4 }
Some { SecurityId = Ticker "DIS"
       Signal = 1.1 }
None</code></pre></td></tr></table>
<p>If we do choose instead of map, then we will
end up with only the results when there was something.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs15', 112)" onmouseover="showTip(event, 'fs15', 112)" class="id">investmentUniverse</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 113)" onmouseover="showTip(event, 'fs24', 113)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 114)" onmouseover="showTip(event, 'fs38', 114)" class="id">choose</span> <span onmouseout="hideTip(event, 'fs30', 115)" onmouseover="showTip(event, 'fs30', 115)" class="fn">getSecuritySignal</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 116)" onmouseover="showTip(event, 'fs24', 116)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs37', 117)" onmouseover="showTip(event, 'fs37', 117)" class="id">iter</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs13', 118)" onmouseover="showTip(event, 'fs13', 118)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%A</span><span class="s">&quot;</span><span class="pn">)</span> 
</code></pre>
<table class="pre"><tr><td><pre><code>{ SecurityId = Ticker "AAPL"
  Signal = 2.0 }
{ SecurityId = Ticker "KO"
  Signal = -1.4 }
{ SecurityId = Ticker "GOOG"
  Signal = 0.4 }
{ SecurityId = Ticker "DIS"
  Signal = 1.1 }</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 119)" onmouseover="showTip(event, 'fs39', 119)" class="id">securitySignals</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs15', 120)" onmouseover="showTip(event, 'fs15', 120)" class="id">investmentUniverse</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 121)" onmouseover="showTip(event, 'fs24', 121)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 122)" onmouseover="showTip(event, 'fs38', 122)" class="id">choose</span> <span onmouseout="hideTip(event, 'fs30', 123)" onmouseover="showTip(event, 'fs30', 123)" class="fn">getSecuritySignal</span>

<span onmouseout="hideTip(event, 'fs39', 124)" onmouseover="showTip(event, 'fs39', 124)" class="id">securitySignals</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 125)" onmouseover="showTip(event, 'fs24', 125)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs37', 126)" onmouseover="showTip(event, 'fs37', 126)" class="id">iter</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs13', 127)" onmouseover="showTip(event, 'fs13', 127)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%A</span><span class="s">&quot;</span><span class="pn">)</span>
</code></pre>
<table class="pre"><tr><td><pre><code>{ SecurityId = Ticker "AAPL"
  Signal = 2.0 }
{ SecurityId = Ticker "KO"
  Signal = -1.4 }
{ SecurityId = Ticker "GOOG"
  Signal = 0.4 }
{ SecurityId = Ticker "DIS"
  Signal = 1.1 }</code></pre></td></tr></table>
<h2><a name="3-Defining-a-mapping-between-signals-and-portfolio-weights" class="anchor" href="#3-Defining-a-mapping-between-signals-and-portfolio-weights">3. Defining a mapping between signals and portfolio weights.</a></h2>
<p>Now let's look at turning signals into weights.</p>
<p>Often, you only want stocks with signals above or below a given threshold in a portfolio. For instance, if you have a "value" portfolio you might only want stocks with low price to earnings (P/E) ratios in your portfolio. Or maybe you want to go long value stocks and short growth stocks.</p>
<p>A typical procedure is to assign securities to portfolios based on signals, and then weight securities within those sub portfolios.</p>
<p>First, let's represent portfolios Ids.
A first step is to define portfolio IDs. A simple ID is a string name, but often we will do things like create 10 size portfolios infexed from 1 to 10, like ("Size", 1), ("Size", 2), ... We can model this as a discriminated union.</p>
<p>Here, <code>Indexed</code> is a tuple where the first element is a string and the second is an integer. I could just say <code>Indexed of string * int</code>, but I am going to name them to give them meaning. Though the names are optional when constructing and deconstructing</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs40', 128)" onmouseover="showTip(event, 'fs40', 128)" class="rt">PortfolioId</span> <span class="o">=</span> 
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs41', 129)" onmouseover="showTip(event, 'fs41', 129)" class="uc">Named</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs5', 130)" onmouseover="showTip(event, 'fs5', 130)" class="rt">string</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs42', 131)" onmouseover="showTip(event, 'fs42', 131)" class="uc">Indexed</span> <span class="k">of</span> <span class="pn">{|</span> <span class="prop">Name</span><span class="pn">:</span> <span onmouseout="hideTip(event, 'fs5', 132)" onmouseover="showTip(event, 'fs5', 132)" class="rt">string</span><span class="pn">;</span> <span class="prop">Index</span><span class="pn">:</span> <span onmouseout="hideTip(event, 'fs9', 133)" onmouseover="showTip(event, 'fs9', 133)" class="vt">int</span> <span class="pn">|}</span><span class="c">// name:string * index:int</span>

<span class="c">// Example portfolio IDs</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs43', 134)" onmouseover="showTip(event, 'fs43', 134)" class="id">portfolioId1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 135)" onmouseover="showTip(event, 'fs41', 135)" class="uc">Named</span> <span class="s">&quot;Market&quot;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs44', 136)" onmouseover="showTip(event, 'fs44', 136)" class="id">portfolioId2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 137)" onmouseover="showTip(event, 'fs42', 137)" class="uc">Indexed</span> <span class="pn">{|</span> <span class="prop">Name</span> <span class="o">=</span> <span class="s">&quot;Size&quot;</span><span class="pn">;</span> <span class="prop">Index</span> <span class="o">=</span> <span class="n">1</span> <span class="pn">|}</span> 
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs45', 138)" onmouseover="showTip(event, 'fs45', 138)" class="id">portfolioId3</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 139)" onmouseover="showTip(event, 'fs42', 139)" class="uc">Indexed</span> <span class="pn">{|</span> <span class="prop">Name</span> <span class="o">=</span> <span class="s">&quot;Size&quot;</span> <span class="pn">;</span> <span class="prop">Index</span> <span class="o">=</span> <span class="n">2</span> <span class="pn">|}</span>    

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 140)" onmouseover="showTip(event, 'fs46', 140)" class="fn">getPortfolioIdString</span> <span onmouseout="hideTip(event, 'fs47', 141)" onmouseover="showTip(event, 'fs47', 141)" class="fn">port</span> <span class="o">=</span>
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs47', 142)" onmouseover="showTip(event, 'fs47', 142)" class="fn">port</span> <span class="k">with</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs41', 143)" onmouseover="showTip(event, 'fs41', 143)" class="uc">Named</span> <span onmouseout="hideTip(event, 'fs48', 144)" onmouseover="showTip(event, 'fs48', 144)" class="fn">name</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs48', 145)" onmouseover="showTip(event, 'fs48', 145)" class="fn">name</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs42', 146)" onmouseover="showTip(event, 'fs42', 146)" class="uc">Indexed</span> <span onmouseout="hideTip(event, 'fs49', 147)" onmouseover="showTip(event, 'fs49', 147)" class="fn">p</span> <span class="k">-&gt;</span> <span class="s">$&quot;{</span><span onmouseout="hideTip(event, 'fs49', 148)" onmouseover="showTip(event, 'fs49', 148)" class="fn">p</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs50', 149)" onmouseover="showTip(event, 'fs50', 149)" class="id">Name</span><span class="s">}: {</span><span onmouseout="hideTip(event, 'fs49', 150)" onmouseover="showTip(event, 'fs49', 150)" class="fn">p</span><span class="pn">.</span><span class="id">Index</span><span class="s">}&quot;</span>


<span onmouseout="hideTip(event, 'fs46', 151)" onmouseover="showTip(event, 'fs46', 151)" class="fn">getPortfolioIdString</span> <span onmouseout="hideTip(event, 'fs43', 152)" onmouseover="showTip(event, 'fs43', 152)" class="id">portfolioId1</span>
</code></pre>
<table class="pre"><tr><td><pre><code>"Market"</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs46', 153)" onmouseover="showTip(event, 'fs46', 153)" class="fn">getPortfolioIdString</span> <span onmouseout="hideTip(event, 'fs45', 154)" onmouseover="showTip(event, 'fs45', 154)" class="id">portfolioId3</span>
</code></pre>
<table class="pre"><tr><td><pre><code>"Size: 2"</code></pre></td></tr></table>
<p>Let's assign securities to portolios based on whether their signal is above or below the median.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Model for an assigned portfolio</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs51', 155)" onmouseover="showTip(event, 'fs51', 155)" class="rt">AssignedPortfolio</span> <span class="o">=</span>
    <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs52', 156)" onmouseover="showTip(event, 'fs52', 156)" class="prop">PortfolioId</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs40', 157)" onmouseover="showTip(event, 'fs40', 157)" class="rt">PortfolioId</span> 
      <span onmouseout="hideTip(event, 'fs53', 158)" onmouseover="showTip(event, 'fs53', 158)" class="prop">Signals</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs54', 159)" onmouseover="showTip(event, 'fs54', 159)" class="rt">list</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs26', 160)" onmouseover="showTip(event, 'fs26', 160)" class="rt">SecuritySignal</span><span class="pn">&gt;</span> <span class="pn">}</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 161)" onmouseover="showTip(event, 'fs55', 161)" class="id">medianSignal</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs39', 162)" onmouseover="showTip(event, 'fs39', 162)" class="id">securitySignals</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 163)" onmouseover="showTip(event, 'fs24', 163)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs25', 164)" onmouseover="showTip(event, 'fs25', 164)" class="id">map</span><span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs56', 165)" onmouseover="showTip(event, 'fs56', 165)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs56', 166)" onmouseover="showTip(event, 'fs56', 166)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs57', 167)" onmouseover="showTip(event, 'fs57', 167)" class="id">Signal</span><span class="pn">)</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs58', 168)" onmouseover="showTip(event, 'fs58', 168)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs59', 169)" onmouseover="showTip(event, 'fs59', 169)" class="id">median</span>
</code></pre>
<p>The median signal is</p>
<table class="pre"><tr><td><pre><code>0.75</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs60', 170)" onmouseover="showTip(event, 'fs60', 170)" class="id">aboveMedian</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs39', 171)" onmouseover="showTip(event, 'fs39', 171)" class="id">securitySignals</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 172)" onmouseover="showTip(event, 'fs24', 172)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs61', 173)" onmouseover="showTip(event, 'fs61', 173)" class="id">filter</span><span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs56', 174)" onmouseover="showTip(event, 'fs56', 174)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs56', 175)" onmouseover="showTip(event, 'fs56', 175)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs57', 176)" onmouseover="showTip(event, 'fs57', 176)" class="id">Signal</span> <span class="o">&gt;</span><span class="o">=</span> <span onmouseout="hideTip(event, 'fs55', 177)" onmouseover="showTip(event, 'fs55', 177)" class="id">medianSignal</span><span class="pn">)</span>
</code></pre>
<p>the above-median securities:</p>
<table class="pre"><tr><td><pre><code>[{ SecurityId = Ticker "AAPL"
   Signal = 2.0 }; { SecurityId = Ticker "DIS"
                     Signal = 1.1 }]</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs62', 178)" onmouseover="showTip(event, 'fs62', 178)" class="id">belowMedian</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs39', 179)" onmouseover="showTip(event, 'fs39', 179)" class="id">securitySignals</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 180)" onmouseover="showTip(event, 'fs24', 180)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs61', 181)" onmouseover="showTip(event, 'fs61', 181)" class="id">filter</span><span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs56', 182)" onmouseover="showTip(event, 'fs56', 182)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs56', 183)" onmouseover="showTip(event, 'fs56', 183)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs57', 184)" onmouseover="showTip(event, 'fs57', 184)" class="id">Signal</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs55', 185)" onmouseover="showTip(event, 'fs55', 185)" class="id">medianSignal</span><span class="pn">)</span>
</code></pre>
<p>the below-median securities:</p>
<table class="pre"><tr><td><pre><code>[{ SecurityId = Ticker "KO"
   Signal = -1.4 }; { SecurityId = Ticker "GOOG"
                      Signal = 0.4 }]</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs63', 186)" onmouseover="showTip(event, 'fs63', 186)" class="id">assigned</span> <span class="o">=</span>
    <span class="pn">[</span> <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs40', 187)" onmouseover="showTip(event, 'fs40', 187)" class="prop">PortfolioId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 188)" onmouseover="showTip(event, 'fs41', 188)" class="uc">Named</span><span class="pn">(</span><span class="s">&quot;Above Median&quot;</span><span class="pn">)</span>
        <span class="prop">Signals</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs60', 189)" onmouseover="showTip(event, 'fs60', 189)" class="id">aboveMedian</span> <span class="pn">}</span>
      <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs40', 190)" onmouseover="showTip(event, 'fs40', 190)" class="prop">PortfolioId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 191)" onmouseover="showTip(event, 'fs41', 191)" class="uc">Named</span><span class="pn">(</span><span class="s">&quot;Below Median&quot;</span><span class="pn">)</span>
        <span class="prop">Signals</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs62', 192)" onmouseover="showTip(event, 'fs62', 192)" class="id">belowMedian</span><span class="pn">}</span> <span class="pn">]</span>
</code></pre>
<p>assigned to portfolios:</p>
<table class="pre"><tr><td><pre><code>[{ PortfolioId = Named "Above Median"
   Signals = [{ SecurityId = Ticker "AAPL"
                Signal = 2.0 }; { SecurityId = Ticker "DIS"
                                  Signal = 1.1 }] };
 { PortfolioId = Named "Below Median"
   Signals = [{ SecurityId = Ticker "KO"
                Signal = -1.4 }; { SecurityId = Ticker "GOOG"
                                   Signal = 0.4 }] }]</code></pre></td></tr></table>
<p>Or create a reusable function to do the same thing</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs64', 193)" onmouseover="showTip(event, 'fs64', 193)" class="fn">assignAboveBelowMedian</span> <span onmouseout="hideTip(event, 'fs39', 194)" onmouseover="showTip(event, 'fs39', 194)" class="fn">securitySignals</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 195)" onmouseover="showTip(event, 'fs55', 195)" class="fn">medianSignal</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs39', 196)" onmouseover="showTip(event, 'fs39', 196)" class="fn">securitySignals</span> 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 197)" onmouseover="showTip(event, 'fs24', 197)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs25', 198)" onmouseover="showTip(event, 'fs25', 198)" class="id">map</span><span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs56', 199)" onmouseover="showTip(event, 'fs56', 199)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs56', 200)" onmouseover="showTip(event, 'fs56', 200)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs57', 201)" onmouseover="showTip(event, 'fs57', 201)" class="id">Signal</span><span class="pn">)</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs58', 202)" onmouseover="showTip(event, 'fs58', 202)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs59', 203)" onmouseover="showTip(event, 'fs59', 203)" class="id">median</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs60', 204)" onmouseover="showTip(event, 'fs60', 204)" class="fn">aboveMedian</span> <span class="o">=</span>
        <span onmouseout="hideTip(event, 'fs39', 205)" onmouseover="showTip(event, 'fs39', 205)" class="fn">securitySignals</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 206)" onmouseover="showTip(event, 'fs24', 206)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs61', 207)" onmouseover="showTip(event, 'fs61', 207)" class="id">filter</span><span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs56', 208)" onmouseover="showTip(event, 'fs56', 208)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs56', 209)" onmouseover="showTip(event, 'fs56', 209)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs57', 210)" onmouseover="showTip(event, 'fs57', 210)" class="id">Signal</span> <span class="o">&gt;</span><span class="o">=</span> <span onmouseout="hideTip(event, 'fs55', 211)" onmouseover="showTip(event, 'fs55', 211)" class="fn">medianSignal</span><span class="pn">)</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs62', 212)" onmouseover="showTip(event, 'fs62', 212)" class="fn">belowMedian</span> <span class="o">=</span>
        <span onmouseout="hideTip(event, 'fs39', 213)" onmouseover="showTip(event, 'fs39', 213)" class="fn">securitySignals</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 214)" onmouseover="showTip(event, 'fs24', 214)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs61', 215)" onmouseover="showTip(event, 'fs61', 215)" class="id">filter</span><span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs56', 216)" onmouseover="showTip(event, 'fs56', 216)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs56', 217)" onmouseover="showTip(event, 'fs56', 217)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs57', 218)" onmouseover="showTip(event, 'fs57', 218)" class="id">Signal</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs55', 219)" onmouseover="showTip(event, 'fs55', 219)" class="fn">medianSignal</span><span class="pn">)</span>

    <span class="pn">[</span> <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs40', 220)" onmouseover="showTip(event, 'fs40', 220)" class="prop">PortfolioId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 221)" onmouseover="showTip(event, 'fs41', 221)" class="uc">Named</span><span class="pn">(</span><span class="s">&quot;Above Median&quot;</span><span class="pn">)</span>
        <span class="prop">Signals</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs60', 222)" onmouseover="showTip(event, 'fs60', 222)" class="fn">aboveMedian</span> <span class="pn">}</span>
      <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs40', 223)" onmouseover="showTip(event, 'fs40', 223)" class="prop">PortfolioId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 224)" onmouseover="showTip(event, 'fs41', 224)" class="uc">Named</span><span class="pn">(</span><span class="s">&quot;Below Median&quot;</span><span class="pn">)</span>
        <span class="prop">Signals</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs62', 225)" onmouseover="showTip(event, 'fs62', 225)" class="fn">belowMedian</span><span class="pn">}</span> <span class="pn">]</span>
</code></pre>
<h2><a name="Modelling-a-position" class="anchor" href="#Modelling-a-position">Modelling a position</a></h2>
<p>Now we have assigned securities to portfolios based on the trading signal. Now we can form weights. We can think of a portfolio as consisting of positions where positions are symbols and weights.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs65', 226)" onmouseover="showTip(event, 'fs65', 226)" class="rt">Position</span> <span class="o">=</span>
    <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs66', 227)" onmouseover="showTip(event, 'fs66', 227)" class="prop">SecurityId</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs3', 228)" onmouseover="showTip(event, 'fs3', 228)" class="rt">SecurityId</span> 
      <span onmouseout="hideTip(event, 'fs67', 229)" onmouseover="showTip(event, 'fs67', 229)" class="prop">Weight</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs29', 230)" onmouseover="showTip(event, 'fs29', 230)" class="vt">float</span> <span class="pn">}</span>

<span class="c">// Defining example positions</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs68', 231)" onmouseover="showTip(event, 'fs68', 231)" class="id">koPosition</span> <span class="o">=</span> <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs3', 232)" onmouseover="showTip(event, 'fs3', 232)" class="prop">SecurityId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 233)" onmouseover="showTip(event, 'fs4', 233)" class="uc">Ticker</span> <span class="s">&quot;KO&quot;</span><span class="pn">;</span> <span class="prop">Weight</span> <span class="o">=</span> <span class="n">0.25</span> <span class="pn">}</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs69', 234)" onmouseover="showTip(event, 'fs69', 234)" class="id">permnoPosition</span> <span class="o">=</span> <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs3', 235)" onmouseover="showTip(event, 'fs3', 235)" class="prop">SecurityId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs8', 236)" onmouseover="showTip(event, 'fs8', 236)" class="uc">Permno</span> <span class="n">1001</span><span class="pn">;</span> <span class="prop">Weight</span> <span class="o">=</span> <span class="n">0.75</span> <span class="pn">}</span>
</code></pre>
<h2><a name="Modelling-a-portfolio" class="anchor" href="#Modelling-a-portfolio">Modelling a portfolio</a></h2>
<p>And once we have multiple positions, then we can group them into a portfolio.</p>
<p>And a portfolio can consist of a Portfolio Id and an List of positions</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs70', 237)" onmouseover="showTip(event, 'fs70', 237)" class="rt">Portfolio</span> <span class="o">=</span> 
    <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs71', 238)" onmouseover="showTip(event, 'fs71', 238)" class="prop">PortfolioId</span><span class="pn">:</span> <span onmouseout="hideTip(event, 'fs40', 239)" onmouseover="showTip(event, 'fs40', 239)" class="rt">PortfolioId</span>
      <span onmouseout="hideTip(event, 'fs72', 240)" onmouseover="showTip(event, 'fs72', 240)" class="prop">Positions</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs54', 241)" onmouseover="showTip(event, 'fs54', 241)" class="rt">list</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs65', 242)" onmouseover="showTip(event, 'fs65', 242)" class="rt">Position</span><span class="pn">&gt;</span> <span class="pn">}</span>
</code></pre>
<p>An example constructing a portfolio</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs73', 243)" onmouseover="showTip(event, 'fs73', 243)" class="id">portfolioExample1</span> <span class="o">=</span>
    <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs40', 244)" onmouseover="showTip(event, 'fs40', 244)" class="prop">PortfolioId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 245)" onmouseover="showTip(event, 'fs41', 245)" class="uc">Named</span> <span class="s">&quot;Example 1&quot;</span>
      <span class="prop">Positions</span> <span class="o">=</span> <span class="pn">[</span> <span onmouseout="hideTip(event, 'fs68', 246)" onmouseover="showTip(event, 'fs68', 246)" class="id">koPosition</span><span class="pn">;</span> <span onmouseout="hideTip(event, 'fs69', 247)" onmouseover="showTip(event, 'fs69', 247)" class="id">permnoPosition</span> <span class="pn">]</span> <span class="pn">}</span>
</code></pre>
<h2><a name="Defining-portfolio-position-weights" class="anchor" href="#Defining-portfolio-position-weights">Defining portfolio position weights</a></h2>
<p>Once you have a portfolio of securities that have met some signal criteria, it is common to weight those securities using either of two simple weighting schemes: equal weight or value weight.</p>
<p>Equal weight means that every security has the same weight.</p>
<p>Value-weight means that you weight securities proportional to their market value. This means that your portfolio put more weight on more valuable securities. Or it "tilts" toward more valuable securities. This weighting scheme is utilized when you want to make sure that you are not putting too much weight on small illiquid securities that are hard to purchase.</p>
<p>Equal-weight is easy:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs74', 248)" onmouseover="showTip(event, 'fs74', 248)" class="id">weightTestPort</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs63', 249)" onmouseover="showTip(event, 'fs63', 249)" class="id">assigned</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 250)" onmouseover="showTip(event, 'fs24', 250)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs75', 251)" onmouseover="showTip(event, 'fs75', 251)" class="id">find</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs76', 252)" onmouseover="showTip(event, 'fs76', 252)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs76', 253)" onmouseover="showTip(event, 'fs76', 253)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs77', 254)" onmouseover="showTip(event, 'fs77', 254)" class="id">PortfolioId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 255)" onmouseover="showTip(event, 'fs41', 255)" class="uc">Named</span><span class="pn">(</span><span class="s">&quot;Above Median&quot;</span><span class="pn">)</span><span class="pn">)</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs78', 256)" onmouseover="showTip(event, 'fs78', 256)" class="id">nSecurities</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs74', 257)" onmouseover="showTip(event, 'fs74', 257)" class="id">weightTestPort</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs53', 258)" onmouseover="showTip(event, 'fs53', 258)" class="prop">Signals</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs79', 259)" onmouseover="showTip(event, 'fs79', 259)" class="id">Length</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs80', 260)" onmouseover="showTip(event, 'fs80', 260)" class="id">ewTestWeights</span> <span class="o">=</span>
    <span class="pn">[</span> <span class="k">for</span> <span onmouseout="hideTip(event, 'fs81', 261)" onmouseover="showTip(event, 'fs81', 261)" class="fn">signal</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs74', 262)" onmouseover="showTip(event, 'fs74', 262)" class="id">weightTestPort</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs53', 263)" onmouseover="showTip(event, 'fs53', 263)" class="id">Signals</span> <span class="k">do</span> 
        <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs3', 264)" onmouseover="showTip(event, 'fs3', 264)" class="prop">SecurityId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs81', 265)" onmouseover="showTip(event, 'fs81', 265)" class="fn">signal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs82', 266)" onmouseover="showTip(event, 'fs82', 266)" class="id">SecurityId</span>
          <span class="prop">Weight</span> <span class="o">=</span> <span class="n">1.0</span> <span class="o">/</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs29', 267)" onmouseover="showTip(event, 'fs29', 267)" class="fn">float</span> <span onmouseout="hideTip(event, 'fs78', 268)" onmouseover="showTip(event, 'fs78', 268)" class="id">nSecurities</span><span class="pn">)</span> <span class="pn">}</span> <span class="pn">]</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs83', 269)" onmouseover="showTip(event, 'fs83', 269)" class="fn">giveEqualWeights</span> <span onmouseout="hideTip(event, 'fs76', 270)" onmouseover="showTip(event, 'fs76', 270)" class="fn">x</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs84', 271)" onmouseover="showTip(event, 'fs84', 271)" class="fn">n</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs76', 272)" onmouseover="showTip(event, 'fs76', 272)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs53', 273)" onmouseover="showTip(event, 'fs53', 273)" class="prop">Signals</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs79', 274)" onmouseover="showTip(event, 'fs79', 274)" class="id">Length</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs85', 275)" onmouseover="showTip(event, 'fs85', 275)" class="fn">pos</span> <span class="o">=</span>
        <span class="pn">[</span> <span class="k">for</span> <span onmouseout="hideTip(event, 'fs81', 276)" onmouseover="showTip(event, 'fs81', 276)" class="fn">signal</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs76', 277)" onmouseover="showTip(event, 'fs76', 277)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs53', 278)" onmouseover="showTip(event, 'fs53', 278)" class="id">Signals</span> <span class="k">do</span> 
            <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs65', 279)" onmouseover="showTip(event, 'fs65', 279)" class="rt">Position</span><span class="pn">.</span><span class="prop">SecurityId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs81', 280)" onmouseover="showTip(event, 'fs81', 280)" class="fn">signal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs82', 281)" onmouseover="showTip(event, 'fs82', 281)" class="id">SecurityId</span>
              <span class="prop">Weight</span> <span class="o">=</span> <span class="n">1.0</span> <span class="o">/</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs29', 282)" onmouseover="showTip(event, 'fs29', 282)" class="fn">float</span> <span onmouseout="hideTip(event, 'fs84', 283)" onmouseover="showTip(event, 'fs84', 283)" class="fn">n</span><span class="pn">)</span> <span class="pn">}</span> <span class="pn">]</span>
    <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs40', 284)" onmouseover="showTip(event, 'fs40', 284)" class="prop">PortfolioId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs76', 285)" onmouseover="showTip(event, 'fs76', 285)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs77', 286)" onmouseover="showTip(event, 'fs77', 286)" class="id">PortfolioId</span> 
      <span class="prop">Positions</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs85', 287)" onmouseover="showTip(event, 'fs85', 287)" class="fn">pos</span> <span class="pn">}</span>
</code></pre>
<p>For one portfolio:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs83', 288)" onmouseover="showTip(event, 'fs83', 288)" class="fn">giveEqualWeights</span> <span onmouseout="hideTip(event, 'fs74', 289)" onmouseover="showTip(event, 'fs74', 289)" class="id">weightTestPort</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Real: 00:00:00.001, CPU: 00:00:00.000, GC gen0: 0, gen1: 0, gen2: 0
val it : Portfolio =
  { PortfolioId = Named "Above Median"
    Positions = [{ SecurityId = Ticker "AAPL"
                   Weight = 0.5 }; { SecurityId = Ticker "DIS"
                                     Weight = 0.5 }] }</code></pre></td></tr></table>
<p>For all portfolios:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="pn">[</span> <span class="k">for</span> <span onmouseout="hideTip(event, 'fs86', 290)" onmouseover="showTip(event, 'fs86', 290)" class="fn">portfolio</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs63', 291)" onmouseover="showTip(event, 'fs63', 291)" class="id">assigned</span> <span class="k">do</span> <span onmouseout="hideTip(event, 'fs83', 292)" onmouseover="showTip(event, 'fs83', 292)" class="fn">giveEqualWeights</span> <span onmouseout="hideTip(event, 'fs86', 293)" onmouseover="showTip(event, 'fs86', 293)" class="fn">portfolio</span> <span class="pn">]</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Real: 00:00:00.001, CPU: 00:00:00.000, GC gen0: 0, gen1: 0, gen2: 0
val it : Portfolio list =
  [{ PortfolioId = Named "Above Median"
     Positions = [{ SecurityId = Ticker "AAPL"
                    Weight = 0.5 }; { SecurityId = Ticker "DIS"
                                      Weight = 0.5 }] };
   { PortfolioId = Named "Below Median"
     Positions = [{ SecurityId = Ticker "KO"
                    Weight = 0.5 }; { SecurityId = Ticker "GOOG"
                                      Weight = 0.5 }] }]</code></pre></td></tr></table>
<p>or equivalently:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs63', 294)" onmouseover="showTip(event, 'fs63', 294)" class="id">assigned</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 295)" onmouseover="showTip(event, 'fs24', 295)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs25', 296)" onmouseover="showTip(event, 'fs25', 296)" class="id">map</span> <span onmouseout="hideTip(event, 'fs83', 297)" onmouseover="showTip(event, 'fs83', 297)" class="fn">giveEqualWeights</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Real: 00:00:00.000, CPU: 00:00:00.000, GC gen0: 0, gen1: 0, gen2: 0
val it : Portfolio list =
  [{ PortfolioId = Named "Above Median"
     Positions = [{ SecurityId = Ticker "AAPL"
                    Weight = 0.5 }; { SecurityId = Ticker "DIS"
                                      Weight = 0.5 }] };
   { PortfolioId = Named "Below Median"
     Positions = [{ SecurityId = Ticker "KO"
                    Weight = 0.5 }; { SecurityId = Ticker "GOOG"
                                      Weight = 0.5 }] }]</code></pre></td></tr></table>
<p>For value weights, we need the securities' market values
split into above/below median and for portfolios with those.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs87', 298)" onmouseover="showTip(event, 'fs87', 298)" class="id">marketCapitalizations</span> <span class="o">=</span>
    <span class="pn">[</span> <span onmouseout="hideTip(event, 'fs4', 299)" onmouseover="showTip(event, 'fs4', 299)" class="uc">Ticker</span> <span class="s">&quot;AAPL&quot;</span><span class="pn">,</span> <span class="n">10.0</span>
      <span onmouseout="hideTip(event, 'fs4', 300)" onmouseover="showTip(event, 'fs4', 300)" class="uc">Ticker</span> <span class="s">&quot;KO&quot;</span><span class="pn">,</span> <span class="n">4.0</span>
      <span onmouseout="hideTip(event, 'fs4', 301)" onmouseover="showTip(event, 'fs4', 301)" class="uc">Ticker</span> <span class="s">&quot;GOOG&quot;</span><span class="pn">,</span> <span class="n">7.0</span> 
      <span onmouseout="hideTip(event, 'fs4', 302)" onmouseover="showTip(event, 'fs4', 302)" class="uc">Ticker</span> <span class="s">&quot;DIS&quot;</span><span class="pn">,</span> <span class="n">5.0</span> <span class="pn">]</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs18', 303)" onmouseover="showTip(event, 'fs18', 303)" class="fn">Map</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs88', 304)" onmouseover="showTip(event, 'fs88', 304)" class="id">mktCaps</span> <span class="o">=</span>
    <span class="pn">[</span> <span class="k">for</span> <span onmouseout="hideTip(event, 'fs81', 305)" onmouseover="showTip(event, 'fs81', 305)" class="fn">signal</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs74', 306)" onmouseover="showTip(event, 'fs74', 306)" class="id">weightTestPort</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs53', 307)" onmouseover="showTip(event, 'fs53', 307)" class="id">Signals</span> <span class="k">do</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs89', 308)" onmouseover="showTip(event, 'fs89', 308)" class="fn">mktcap</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs18', 309)" onmouseover="showTip(event, 'fs18', 309)" class="m">Map</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs19', 310)" onmouseover="showTip(event, 'fs19', 310)" class="id">find</span> <span onmouseout="hideTip(event, 'fs81', 311)" onmouseover="showTip(event, 'fs81', 311)" class="fn">signal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs82', 312)" onmouseover="showTip(event, 'fs82', 312)" class="id">SecurityId</span> <span onmouseout="hideTip(event, 'fs87', 313)" onmouseover="showTip(event, 'fs87', 313)" class="id">marketCapitalizations</span>
        <span onmouseout="hideTip(event, 'fs81', 314)" onmouseover="showTip(event, 'fs81', 314)" class="fn">signal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs82', 315)" onmouseover="showTip(event, 'fs82', 315)" class="id">SecurityId</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs89', 316)" onmouseover="showTip(event, 'fs89', 316)" class="fn">mktcap</span> <span class="pn">]</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Real: 00:00:00.001, CPU: 00:00:00.000, GC gen0: 0, gen1: 0, gen2: 0
val marketCapitalizations : Map&lt;SecurityId,float&gt; =
  map
    [(Ticker "AAPL", 10.0); (Ticker "DIS", 5.0); (Ticker "GOOG", 7.0);
     (Ticker "KO", 4.0)]
val mktCaps : (SecurityId * float) list =
  [(Ticker "AAPL", 10.0); (Ticker "DIS", 5.0)]</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs90', 317)" onmouseover="showTip(event, 'fs90', 317)" class="id">vwTestWeights</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs91', 318)" onmouseover="showTip(event, 'fs91', 318)" class="fn">totMktCap</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs88', 319)" onmouseover="showTip(event, 'fs88', 319)" class="id">mktCaps</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 320)" onmouseover="showTip(event, 'fs24', 320)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs92', 321)" onmouseover="showTip(event, 'fs92', 321)" class="id">sumBy</span> <span onmouseout="hideTip(event, 'fs93', 322)" onmouseover="showTip(event, 'fs93', 322)" class="fn">snd</span>
    <span class="pn">[</span> <span class="k">for</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs22', 323)" onmouseover="showTip(event, 'fs22', 323)" class="fn">id</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs94', 324)" onmouseover="showTip(event, 'fs94', 324)" class="fn">mktCap</span><span class="pn">)</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs88', 325)" onmouseover="showTip(event, 'fs88', 325)" class="id">mktCaps</span> <span class="k">do</span> 
        <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs3', 326)" onmouseover="showTip(event, 'fs3', 326)" class="prop">SecurityId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs22', 327)" onmouseover="showTip(event, 'fs22', 327)" class="fn">id</span> 
          <span class="prop">Weight</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs94', 328)" onmouseover="showTip(event, 'fs94', 328)" class="fn">mktCap</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs91', 329)" onmouseover="showTip(event, 'fs91', 329)" class="fn">totMktCap</span> <span class="pn">}</span> <span class="pn">]</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Real: 00:00:00.001, CPU: 00:00:00.000, GC gen0: 0, gen1: 0, gen2: 0
val vwTestWeights : Position list =
  [{ SecurityId = Ticker "AAPL"
     Weight = 0.6666666667 }; { SecurityId = Ticker "DIS"
                                Weight = 0.3333333333 }]</code></pre></td></tr></table>
<p>Now a function to do the same as above.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs95', 330)" onmouseover="showTip(event, 'fs95', 330)" class="fn">giveValueWeights</span> <span onmouseout="hideTip(event, 'fs76', 331)" onmouseover="showTip(event, 'fs76', 331)" class="fn">x</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs88', 332)" onmouseover="showTip(event, 'fs88', 332)" class="fn">mktCaps</span> <span class="o">=</span>
        <span class="pn">[</span> <span class="k">for</span> <span onmouseout="hideTip(event, 'fs81', 333)" onmouseover="showTip(event, 'fs81', 333)" class="fn">signal</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs76', 334)" onmouseover="showTip(event, 'fs76', 334)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs53', 335)" onmouseover="showTip(event, 'fs53', 335)" class="id">Signals</span> <span class="k">do</span> 
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs89', 336)" onmouseover="showTip(event, 'fs89', 336)" class="fn">mktcap</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs18', 337)" onmouseover="showTip(event, 'fs18', 337)" class="m">Map</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs19', 338)" onmouseover="showTip(event, 'fs19', 338)" class="id">find</span> <span onmouseout="hideTip(event, 'fs81', 339)" onmouseover="showTip(event, 'fs81', 339)" class="fn">signal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs82', 340)" onmouseover="showTip(event, 'fs82', 340)" class="id">SecurityId</span> <span onmouseout="hideTip(event, 'fs87', 341)" onmouseover="showTip(event, 'fs87', 341)" class="id">marketCapitalizations</span>
            <span onmouseout="hideTip(event, 'fs81', 342)" onmouseover="showTip(event, 'fs81', 342)" class="fn">signal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs82', 343)" onmouseover="showTip(event, 'fs82', 343)" class="id">SecurityId</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs89', 344)" onmouseover="showTip(event, 'fs89', 344)" class="fn">mktcap</span> <span class="pn">]</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs91', 345)" onmouseover="showTip(event, 'fs91', 345)" class="fn">totMktCap</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs88', 346)" onmouseover="showTip(event, 'fs88', 346)" class="fn">mktCaps</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 347)" onmouseover="showTip(event, 'fs24', 347)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs92', 348)" onmouseover="showTip(event, 'fs92', 348)" class="id">sumBy</span> <span onmouseout="hideTip(event, 'fs93', 349)" onmouseover="showTip(event, 'fs93', 349)" class="fn">snd</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs85', 350)" onmouseover="showTip(event, 'fs85', 350)" class="fn">pos</span> <span class="o">=</span>
        <span class="pn">[</span> <span class="k">for</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs22', 351)" onmouseover="showTip(event, 'fs22', 351)" class="fn">id</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs94', 352)" onmouseover="showTip(event, 'fs94', 352)" class="fn">mktCap</span><span class="pn">)</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs88', 353)" onmouseover="showTip(event, 'fs88', 353)" class="fn">mktCaps</span> <span class="k">do</span> 
            <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs3', 354)" onmouseover="showTip(event, 'fs3', 354)" class="prop">SecurityId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs22', 355)" onmouseover="showTip(event, 'fs22', 355)" class="fn">id</span> 
              <span class="prop">Weight</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs94', 356)" onmouseover="showTip(event, 'fs94', 356)" class="fn">mktCap</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs91', 357)" onmouseover="showTip(event, 'fs91', 357)" class="fn">totMktCap</span> <span class="pn">}</span> <span class="pn">]</span>
    <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs40', 358)" onmouseover="showTip(event, 'fs40', 358)" class="prop">PortfolioId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs76', 359)" onmouseover="showTip(event, 'fs76', 359)" class="fn">x</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs77', 360)" onmouseover="showTip(event, 'fs77', 360)" class="id">PortfolioId</span><span class="pn">;</span> <span class="prop">Positions</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs85', 361)" onmouseover="showTip(event, 'fs85', 361)" class="fn">pos</span> <span class="pn">}</span>
</code></pre>
<p>We can map our function to both of our assigned portfolios.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="pn">[</span> <span class="k">for</span> <span onmouseout="hideTip(event, 'fs76', 362)" onmouseover="showTip(event, 'fs76', 362)" class="fn">x</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs63', 363)" onmouseover="showTip(event, 'fs63', 363)" class="id">assigned</span> <span class="k">do</span> <span onmouseout="hideTip(event, 'fs95', 364)" onmouseover="showTip(event, 'fs95', 364)" class="fn">giveValueWeights</span> <span onmouseout="hideTip(event, 'fs76', 365)" onmouseover="showTip(event, 'fs76', 365)" class="fn">x</span> <span class="pn">]</span>
</code></pre>
<table class="pre"><tr><td><pre><code>[{ PortfolioId = Named "Above Median"
   Positions = [{ SecurityId = Ticker "AAPL"
                  Weight = 0.6666666667 }; { SecurityId = Ticker "DIS"
                                             Weight = 0.3333333333 }] };
 { PortfolioId = Named "Below Median"
   Positions = [{ SecurityId = Ticker "KO"
                  Weight = 0.3636363636 }; { SecurityId = Ticker "GOOG"
                                             Weight = 0.6363636364 }] }]</code></pre></td></tr></table>
<p>or equivalently</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs63', 366)" onmouseover="showTip(event, 'fs63', 366)" class="id">assigned</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 367)" onmouseover="showTip(event, 'fs24', 367)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs25', 368)" onmouseover="showTip(event, 'fs25', 368)" class="id">map</span> <span onmouseout="hideTip(event, 'fs95', 369)" onmouseover="showTip(event, 'fs95', 369)" class="fn">giveValueWeights</span>  
</code></pre>
<table class="pre"><tr><td><pre><code>[{ PortfolioId = Named "Above Median"
   Positions = [{ SecurityId = Ticker "AAPL"
                  Weight = 0.6666666667 }; { SecurityId = Ticker "DIS"
                                             Weight = 0.3333333333 }] };
 { PortfolioId = Named "Below Median"
   Positions = [{ SecurityId = Ticker "KO"
                  Weight = 0.3636363636 }; { SecurityId = Ticker "GOOG"
                                             Weight = 0.6363636364 }] }]</code></pre></td></tr></table>
<p>All together now. This is our workflow.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs96', 370)" onmouseover="showTip(event, 'fs96', 370)" class="id">strategyWeights</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs15', 371)" onmouseover="showTip(event, 'fs15', 371)" class="id">investmentUniverse</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 372)" onmouseover="showTip(event, 'fs24', 372)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 373)" onmouseover="showTip(event, 'fs38', 373)" class="id">choose</span> <span onmouseout="hideTip(event, 'fs30', 374)" onmouseover="showTip(event, 'fs30', 374)" class="fn">getSecuritySignal</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs64', 375)" onmouseover="showTip(event, 'fs64', 375)" class="fn">assignAboveBelowMedian</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs24', 376)" onmouseover="showTip(event, 'fs24', 376)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs25', 377)" onmouseover="showTip(event, 'fs25', 377)" class="id">map</span> <span onmouseout="hideTip(event, 'fs95', 378)" onmouseover="showTip(event, 'fs95', 378)" class="fn">giveValueWeights</span>
</code></pre>
<table class="pre"><tr><td><pre><code>Real: 00:00:00.002, CPU: 00:00:00.000, GC gen0: 0, gen1: 0, gen2: 0
val strategyWeights : Portfolio list =
  [{ PortfolioId = Named "Above Median"
     Positions = [{ SecurityId = Ticker "AAPL"
                    Weight = 0.6666666667 }; { SecurityId = Ticker "DIS"
                                               Weight = 0.3333333333 }] };
   { PortfolioId = Named "Below Median"
     Positions = [{ SecurityId = Ticker "KO"
                    Weight = 0.3636363636 }; { SecurityId = Ticker "GOOG"
                                               Weight = 0.6363636364 }] }]</code></pre></td></tr></table>
<h1><a name="How-do-we-calculate-returns" class="anchor" href="#How-do-we-calculate-returns">How do we calculate returns?</a></h1>
<p>Take these returns:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs97', 379)" onmouseover="showTip(event, 'fs97', 379)" class="id">returnMap</span> <span class="o">=</span>
    <span class="pn">[</span> <span onmouseout="hideTip(event, 'fs4', 380)" onmouseover="showTip(event, 'fs4', 380)" class="uc">Ticker</span> <span class="s">&quot;AAPL&quot;</span><span class="pn">,</span> <span class="o">-</span><span class="n">0.4</span>
      <span onmouseout="hideTip(event, 'fs4', 381)" onmouseover="showTip(event, 'fs4', 381)" class="uc">Ticker</span> <span class="s">&quot;KO&quot;</span><span class="pn">,</span> <span class="o">-</span><span class="n">0.1</span>
      <span onmouseout="hideTip(event, 'fs4', 382)" onmouseover="showTip(event, 'fs4', 382)" class="uc">Ticker</span> <span class="s">&quot;GOOG&quot;</span><span class="pn">,</span> <span class="n">0.15</span> 
      <span onmouseout="hideTip(event, 'fs4', 383)" onmouseover="showTip(event, 'fs4', 383)" class="uc">Ticker</span> <span class="s">&quot;DIS&quot;</span><span class="pn">,</span> <span class="n">0.1</span> <span class="pn">]</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs18', 384)" onmouseover="showTip(event, 'fs18', 384)" class="fn">Map</span>
</code></pre>
<p>What is the return of the two portfolios?</p>
<p>Hint: the value-weight assignment code is a good reference for figuring out how to look up the stock returns.</p>

            <div class="fsdocs-tip" id="fs1">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="fsdocs-tip" id="fs2">namespace FSharp.Stats</div>
<div class="fsdocs-tip" id="fs3">type SecurityId =
  | Ticker of string
  | Cusip of string
  | Bloomberg of string
  | Permno of int</div>
<div class="fsdocs-tip" id="fs4">union case SecurityId.Ticker: string -&gt; SecurityId</div>
<div class="fsdocs-tip" id="fs5">Multiple items<br />val string : value:&#39;T -&gt; string<br /><em>&lt;summary&gt;Converts the argument to a string using &lt;c&gt;ToString&lt;/c&gt;.&lt;/summary&gt;<br />&lt;remarks&gt;For standard integer and floating point values the and any type that implements &lt;c&gt;IFormattable&lt;/c&gt;&lt;c&gt;ToString&lt;/c&gt; conversion uses &lt;c&gt;CultureInfo.InvariantCulture&lt;/c&gt;. &lt;/remarks&gt;<br />&lt;param name=&quot;value&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;The converted string.&lt;/returns&gt;</em><br /><br />--------------------<br />type string = System.String<br /><em>&lt;summary&gt;An abbreviation for the CLI type &lt;see cref=&quot;T:System.String&quot; /&gt;.&lt;/summary&gt;<br />&lt;category&gt;Basic Types&lt;/category&gt;</em></div>
<div class="fsdocs-tip" id="fs6">union case SecurityId.Cusip: string -&gt; SecurityId</div>
<div class="fsdocs-tip" id="fs7">union case SecurityId.Bloomberg: string -&gt; SecurityId</div>
<div class="fsdocs-tip" id="fs8">union case SecurityId.Permno: int -&gt; SecurityId</div>
<div class="fsdocs-tip" id="fs9">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><em>&lt;summary&gt;Converts the argument to signed 32-bit integer. This is a direct conversion for all 
 primitive numeric types. For strings, the input is converted using &lt;c&gt;Int32.Parse()&lt;/c&gt;  
 with InvariantCulture settings. Otherwise the operation requires an appropriate
 static conversion method on the input type.&lt;/summary&gt;<br />&lt;param name=&quot;value&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;The converted int&lt;/returns&gt;</em><br /><br />--------------------<br />[&lt;Struct&gt;]
type int = int32<br /><em>&lt;summary&gt;An abbreviation for the CLI type &lt;see cref=&quot;T:System.Int32&quot; /&gt;.&lt;/summary&gt;<br />&lt;category&gt;Basic Types&lt;/category&gt;</em><br /><br />--------------------<br />type int&lt;&#39;Measure&gt; =
  int<br /><em>&lt;summary&gt;The type of 32-bit signed integer numbers, annotated with a unit of measure. The unit
 of measure is erased in compiled code and when values of this type
 are analyzed using reflection. The type is representationally equivalent to 
 &lt;see cref=&quot;T:System.Int32&quot; /&gt;.&lt;/summary&gt;<br />&lt;category&gt;Basic Types with Units of Measure&lt;/category&gt;</em></div>
<div class="fsdocs-tip" id="fs10">val tickerExample : SecurityId</div>
<div class="fsdocs-tip" id="fs11">val permnoExample : SecurityId</div>
<div class="fsdocs-tip" id="fs12">val deconTickerExample : string</div>
<div class="fsdocs-tip" id="fs13">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><em>&lt;summary&gt;Print to &lt;c&gt;stdout&lt;/c&gt; using the given format, and add a newline.&lt;/summary&gt;<br />&lt;param name=&quot;format&quot;&gt;The formatter.&lt;/param&gt;<br />&lt;returns&gt;The formatted result.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs14">val deconPermnoExample : int</div>
<div class="fsdocs-tip" id="fs15">val investmentUniverse : SecurityId list</div>
<div class="fsdocs-tip" id="fs16">val tick : string</div>
<div class="fsdocs-tip" id="fs17">val signals : Map&lt;SecurityId,float&gt;</div>
<div class="fsdocs-tip" id="fs18">Multiple items<br />module Map

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with values of type &lt;see cref=&quot;T:Microsoft.FSharp.Collections.Map`2&quot; /&gt;.&lt;/summary&gt;</em><br /><br />--------------------<br />type Map&lt;&#39;Key,&#39;Value (requires comparison)&gt; =
  interface IReadOnlyDictionary&lt;&#39;Key,&#39;Value&gt;
  interface IReadOnlyCollection&lt;KeyValuePair&lt;&#39;Key,&#39;Value&gt;&gt;
  interface IEnumerable
  interface IComparable
  interface IEnumerable&lt;KeyValuePair&lt;&#39;Key,&#39;Value&gt;&gt;
  interface ICollection&lt;KeyValuePair&lt;&#39;Key,&#39;Value&gt;&gt;
  interface IDictionary&lt;&#39;Key,&#39;Value&gt;
  new : elements:seq&lt;&#39;Key * &#39;Value&gt; -&gt; Map&lt;&#39;Key,&#39;Value&gt;
  member Add : key:&#39;Key * value:&#39;Value -&gt; Map&lt;&#39;Key,&#39;Value&gt;
  member Change : key:&#39;Key * f:(&#39;Value option -&gt; &#39;Value option) -&gt; Map&lt;&#39;Key,&#39;Value&gt;
  ...<br /><em>&lt;summary&gt;Immutable maps based on binary trees, where keys are ordered by F# generic comparison. By default
 comparison is the F# structural comparison function or uses implementations of the IComparable interface on key values.&lt;/summary&gt;<br />&lt;remarks&gt;See the &lt;see cref=&quot;T:Microsoft.FSharp.Collections.MapModule&quot; /&gt; module for further operations on maps.

 All members of this class are thread-safe and may be used concurrently from multiple threads.&lt;/remarks&gt;</em><br /><br />--------------------<br />new : elements:seq&lt;&#39;Key * &#39;Value&gt; -&gt; Map&lt;&#39;Key,&#39;Value&gt;</div>
<div class="fsdocs-tip" id="fs19">val find : key:&#39;Key -&gt; table:Map&lt;&#39;Key,&#39;T&gt; -&gt; &#39;T (requires comparison)<br /><em>&lt;summary&gt;Lookup an element in the map, raising &lt;c&gt;KeyNotFoundException&lt;/c&gt; if no binding
 exists in the map.&lt;/summary&gt;<br />&lt;param name=&quot;key&quot;&gt;The input key.&lt;/param&gt;<br />&lt;param name=&quot;table&quot;&gt;The input map.&lt;/param&gt;<br />&lt;exception cref=&quot;T:System.Collections.Generic.KeyNotFoundException&quot;&gt;Thrown when the key does not exist in the map.&lt;/exception&gt;<br />&lt;returns&gt;The value mapped to the given key.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs20">val tryFind : key:&#39;Key -&gt; table:Map&lt;&#39;Key,&#39;T&gt; -&gt; &#39;T option (requires comparison)<br /><em>&lt;summary&gt;Lookup an element in the map, returning a &lt;c&gt;Some&lt;/c&gt; value if the element is in the domain 
 of the map and &lt;c&gt;None&lt;/c&gt; if not.&lt;/summary&gt;<br />&lt;param name=&quot;key&quot;&gt;The input key.&lt;/param&gt;<br />&lt;param name=&quot;table&quot;&gt;The input map.&lt;/param&gt;<br />&lt;returns&gt;The found &lt;c&gt;Some&lt;/c&gt; value or &lt;c&gt;None&lt;/c&gt;.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs21">val getSignal : id:SecurityId -&gt; float option</div>
<div class="fsdocs-tip" id="fs22">val id : SecurityId</div>
<div class="fsdocs-tip" id="fs23">val security : SecurityId</div>
<div class="fsdocs-tip" id="fs24">Multiple items<br />module List

from FSharp.Stats<br /><em>&lt;summary&gt;
 Module to compute common statistical measure on list
&lt;/summary&gt;</em><br /><br />--------------------<br />module List

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with values of type &lt;see cref=&quot;T:Microsoft.FSharp.Collections.list`1&quot; /&gt;.&lt;/summary&gt;<br />&lt;namespacedoc&gt;&lt;summary&gt;Operations for collections such as lists, arrays, sets, maps and sequences. See also 
    &lt;a href=&quot;https://docs.microsoft.com/dotnet/fsharp/language-reference/fsharp-collection-types&quot;&gt;F# Collection Types&lt;/a&gt; in the F# Language Guide.
 &lt;/summary&gt;&lt;/namespacedoc&gt;</em><br /><br />--------------------<br />type List&lt;&#39;T&gt; =
  | ( [] )
  | ( :: ) of Head: &#39;T * Tail: &#39;T list
    interface IReadOnlyList&lt;&#39;T&gt;
    interface IReadOnlyCollection&lt;&#39;T&gt;
    interface IEnumerable
    interface IEnumerable&lt;&#39;T&gt;
    member GetReverseIndex : rank:int * offset:int -&gt; int
    member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list
    static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list
    member Head : &#39;T
    member IsEmpty : bool
    member Item : index:int -&gt; &#39;T with get
    ...<br /><em>&lt;summary&gt;The type of immutable singly-linked lists.&lt;/summary&gt;<br />&lt;remarks&gt;Use the constructors &lt;c&gt;[]&lt;/c&gt; and &lt;c&gt;::&lt;/c&gt; (infix) to create values of this type, or
 the notation &lt;c&gt;[1;2;3]&lt;/c&gt;. Use the values in the &lt;c&gt;List&lt;/c&gt; module to manipulate 
 values of this type, or pattern match against the values directly.
 &lt;/remarks&gt;<br />&lt;exclude /&gt;</em></div>
<div class="fsdocs-tip" id="fs25">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U list<br /><em>&lt;summary&gt;Builds a new collection whose elements are the results of applying the given function
 to each of the elements of the collection.&lt;/summary&gt;<br />&lt;param name=&quot;mapping&quot;&gt;The function to transform elements from the input list.&lt;/param&gt;<br />&lt;param name=&quot;list&quot;&gt;The input list.&lt;/param&gt;<br />&lt;returns&gt;The list of transformed elements.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs26">type SecuritySignal =
  { SecurityId: SecurityId
    Signal: float }</div>
<div class="fsdocs-tip" id="fs27">Multiple items<br />SecuritySignal.SecurityId: SecurityId<br /><br />--------------------<br />type SecurityId =
  | Ticker of string
  | Cusip of string
  | Bloomberg of string
  | Permno of int</div>
<div class="fsdocs-tip" id="fs28">Multiple items<br />SecuritySignal.Signal: float<br /><br />--------------------<br />namespace FSharp.Stats.Signal</div>
<div class="fsdocs-tip" id="fs29">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><em>&lt;summary&gt;Converts the argument to 64-bit float. This is a direct conversion for all 
 primitive numeric types. For strings, the input is converted using &lt;c&gt;Double.Parse()&lt;/c&gt;  
 with InvariantCulture settings. Otherwise the operation requires an appropriate
 static conversion method on the input type.&lt;/summary&gt;<br />&lt;param name=&quot;value&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;The converted float&lt;/returns&gt;</em><br /><br />--------------------<br />[&lt;Struct&gt;]
type float = System.Double<br /><em>&lt;summary&gt;An abbreviation for the CLI type &lt;see cref=&quot;T:System.Double&quot; /&gt;.&lt;/summary&gt;<br />&lt;category&gt;Basic Types&lt;/category&gt;</em><br /><br />--------------------<br />type float&lt;&#39;Measure&gt; =
  float<br /><em>&lt;summary&gt;The type of double-precision floating point numbers, annotated with a unit of measure. 
 The unit of measure is erased in compiled code and when values of this type
 are analyzed using reflection. The type is representationally equivalent to 
 &lt;see cref=&quot;T:System.Double&quot; /&gt;.&lt;/summary&gt;<br />&lt;category index=&quot;6&quot;&gt;Basic Types with Units of Measure&lt;/category&gt;</em></div>
<div class="fsdocs-tip" id="fs30">val getSecuritySignal : security:SecurityId -&gt; SecuritySignal option</div>
<div class="fsdocs-tip" id="fs31">union case Option.None: Option&lt;&#39;T&gt;<br /><em>&lt;summary&gt;The representation of &quot;No value&quot;&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs32">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;<br /><em>&lt;summary&gt;The representation of &quot;Value of type &#39;T&quot;&lt;/summary&gt;<br />&lt;param name=&quot;Value&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;An option representing the value.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs33">val signal : float</div>
<div class="fsdocs-tip" id="fs34">val result : SecuritySignal</div>
<div class="fsdocs-tip" id="fs35">namespace FSharp.Stats.Signal</div>
<div class="fsdocs-tip" id="fs36">val securitySignal : SecuritySignal option</div>
<div class="fsdocs-tip" id="fs37">val iter : action:(&#39;T -&gt; unit) -&gt; list:&#39;T list -&gt; unit<br /><em>&lt;summary&gt;Applies the given function to each element of the collection.&lt;/summary&gt;<br />&lt;param name=&quot;action&quot;&gt;The function to apply to elements from the input list.&lt;/param&gt;<br />&lt;param name=&quot;list&quot;&gt;The input list.&lt;/param&gt;</em></div>
<div class="fsdocs-tip" id="fs38">val choose : chooser:(&#39;T -&gt; &#39;U option) -&gt; list:&#39;T list -&gt; &#39;U list<br /><em>&lt;summary&gt;Applies the given function to each element of the list. Returns
 the list comprised of the results &lt;c&gt;x&lt;/c&gt; for each element where
 the function returns Some(x)&lt;/summary&gt;<br />&lt;param name=&quot;chooser&quot;&gt;The function to generate options from the elements.&lt;/param&gt;<br />&lt;param name=&quot;list&quot;&gt;The input list.&lt;/param&gt;<br />&lt;returns&gt;The list comprising the values selected from the chooser function.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs39">val securitySignals : SecuritySignal list</div>
<div class="fsdocs-tip" id="fs40">type PortfolioId =
  | Named of string
  | Indexed of {| Index: int; Name: string |}</div>
<div class="fsdocs-tip" id="fs41">union case PortfolioId.Named: string -&gt; PortfolioId</div>
<div class="fsdocs-tip" id="fs42">union case PortfolioId.Indexed: {| Index: int; Name: string |} -&gt; PortfolioId</div>
<div class="fsdocs-tip" id="fs43">val portfolioId1 : PortfolioId</div>
<div class="fsdocs-tip" id="fs44">val portfolioId2 : PortfolioId</div>
<div class="fsdocs-tip" id="fs45">val portfolioId3 : PortfolioId</div>
<div class="fsdocs-tip" id="fs46">val getPortfolioIdString : port:PortfolioId -&gt; string</div>
<div class="fsdocs-tip" id="fs47">val port : PortfolioId</div>
<div class="fsdocs-tip" id="fs48">val name : string</div>
<div class="fsdocs-tip" id="fs49">val p : {| Index: int; Name: string |}</div>
<div class="fsdocs-tip" id="fs50">anonymous record field Name: string</div>
<div class="fsdocs-tip" id="fs51">type AssignedPortfolio =
  { PortfolioId: PortfolioId
    Signals: SecuritySignal list }</div>
<div class="fsdocs-tip" id="fs52">Multiple items<br />AssignedPortfolio.PortfolioId: PortfolioId<br /><br />--------------------<br />type PortfolioId =
  | Named of string
  | Indexed of {| Index: int; Name: string |}</div>
<div class="fsdocs-tip" id="fs53">AssignedPortfolio.Signals: SecuritySignal list</div>
<div class="fsdocs-tip" id="fs54">type &#39;T list = List&lt;&#39;T&gt;<br /><em>&lt;summary&gt;The type of immutable singly-linked lists. &lt;/summary&gt;<br />&lt;remarks&gt;See the &lt;see cref=&quot;T:Microsoft.FSharp.Collections.ListModule&quot; /&gt; module for further operations related to lists.

 Use the constructors &lt;c&gt;[]&lt;/c&gt; and &lt;c&gt;::&lt;/c&gt; (infix) to create values of this type, or
 the notation &lt;c&gt;[1; 2; 3]&lt;/c&gt;. Use the values in the &lt;c&gt;List&lt;/c&gt; module to manipulate 
 values of this type, or pattern match against the values directly.

  See also &lt;a href=&quot;https://docs.microsoft.com/dotnet/fsharp/language-reference/lists&quot;&gt;F# Language Guide - Lists&lt;/a&gt;.
 &lt;/remarks&gt;</em></div>
<div class="fsdocs-tip" id="fs55">val medianSignal : float</div>
<div class="fsdocs-tip" id="fs56">val x : SecuritySignal</div>
<div class="fsdocs-tip" id="fs57">SecuritySignal.Signal: float</div>
<div class="fsdocs-tip" id="fs58">Multiple items<br />module Seq

from FSharp.Stats<br /><em>&lt;summary&gt;
 Module to compute common statistical measure
&lt;/summary&gt;</em><br /><br />--------------------<br />module Seq

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with values of type &lt;see cref=&quot;T:Microsoft.FSharp.Collections.seq`1&quot; /&gt;.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs59">val median : items:seq&lt;&#39;T&gt; -&gt; &#39;T (requires comparison and member get_Zero and member get_One and member ( + ) and member ( / ) and member ( / ))<br /><em>&lt;summary&gt;
 Sample Median
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs60">val aboveMedian : SecuritySignal list</div>
<div class="fsdocs-tip" id="fs61">val filter : predicate:(&#39;T -&gt; bool) -&gt; list:&#39;T list -&gt; &#39;T list<br /><em>&lt;summary&gt;Returns a new collection containing only the elements of the collection
 for which the given predicate returns &quot;true&quot;&lt;/summary&gt;<br />&lt;param name=&quot;predicate&quot;&gt;The function to test the input elements.&lt;/param&gt;<br />&lt;param name=&quot;list&quot;&gt;The input list.&lt;/param&gt;<br />&lt;returns&gt;A list containing only the elements that satisfy the predicate.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs62">val belowMedian : SecuritySignal list</div>
<div class="fsdocs-tip" id="fs63">val assigned : AssignedPortfolio list</div>
<div class="fsdocs-tip" id="fs64">val assignAboveBelowMedian : securitySignals:SecuritySignal list -&gt; AssignedPortfolio list</div>
<div class="fsdocs-tip" id="fs65">type Position =
  { SecurityId: SecurityId
    Weight: float }</div>
<div class="fsdocs-tip" id="fs66">Multiple items<br />Position.SecurityId: SecurityId<br /><br />--------------------<br />type SecurityId =
  | Ticker of string
  | Cusip of string
  | Bloomberg of string
  | Permno of int</div>
<div class="fsdocs-tip" id="fs67">Position.Weight: float</div>
<div class="fsdocs-tip" id="fs68">val koPosition : Position</div>
<div class="fsdocs-tip" id="fs69">val permnoPosition : Position</div>
<div class="fsdocs-tip" id="fs70">type Portfolio =
  { PortfolioId: PortfolioId
    Positions: Position list }</div>
<div class="fsdocs-tip" id="fs71">Multiple items<br />Portfolio.PortfolioId: PortfolioId<br /><br />--------------------<br />type PortfolioId =
  | Named of string
  | Indexed of {| Index: int; Name: string |}</div>
<div class="fsdocs-tip" id="fs72">Portfolio.Positions: Position list</div>
<div class="fsdocs-tip" id="fs73">val portfolioExample1 : Portfolio</div>
<div class="fsdocs-tip" id="fs74">val weightTestPort : AssignedPortfolio</div>
<div class="fsdocs-tip" id="fs75">val find : predicate:(&#39;T -&gt; bool) -&gt; list:&#39;T list -&gt; &#39;T<br /><em>&lt;summary&gt;Returns the first element for which the given function returns True.
 Raises &lt;c&gt;KeyNotFoundException&lt;/c&gt; if no such element exists.&lt;/summary&gt;<br />&lt;param name=&quot;predicate&quot;&gt;The function to test the input elements.&lt;/param&gt;<br />&lt;param name=&quot;list&quot;&gt;The input list.&lt;/param&gt;<br />&lt;exception cref=&quot;T:System.Collections.Generic.KeyNotFoundException&quot;&gt;Thrown if the predicate evaluates to false for
 all the elements of the list.&lt;/exception&gt;<br />&lt;returns&gt;The first element that satisfies the predicate.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs76">val x : AssignedPortfolio</div>
<div class="fsdocs-tip" id="fs77">AssignedPortfolio.PortfolioId: PortfolioId</div>
<div class="fsdocs-tip" id="fs78">val nSecurities : int</div>
<div class="fsdocs-tip" id="fs79">property List.Length: int with get<br /><em>&lt;summary&gt;Gets the number of items contained in the list&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs80">val ewTestWeights : Position list</div>
<div class="fsdocs-tip" id="fs81">val signal : SecuritySignal</div>
<div class="fsdocs-tip" id="fs82">SecuritySignal.SecurityId: SecurityId</div>
<div class="fsdocs-tip" id="fs83">val giveEqualWeights : x:AssignedPortfolio -&gt; Portfolio</div>
<div class="fsdocs-tip" id="fs84">val n : int</div>
<div class="fsdocs-tip" id="fs85">val pos : Position list</div>
<div class="fsdocs-tip" id="fs86">val portfolio : AssignedPortfolio</div>
<div class="fsdocs-tip" id="fs87">val marketCapitalizations : Map&lt;SecurityId,float&gt;</div>
<div class="fsdocs-tip" id="fs88">val mktCaps : (SecurityId * float) list</div>
<div class="fsdocs-tip" id="fs89">val mktcap : float</div>
<div class="fsdocs-tip" id="fs90">val vwTestWeights : Position list</div>
<div class="fsdocs-tip" id="fs91">val totMktCap : float</div>
<div class="fsdocs-tip" id="fs92">val sumBy : projection:(&#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U (requires member ( + ) and member get_Zero)<br /><em>&lt;summary&gt;Returns the sum of the results generated by applying the function to each element of the list.&lt;/summary&gt;<br />&lt;param name=&quot;projection&quot;&gt;The function to transform the list elements into the type to be summed.&lt;/param&gt;<br />&lt;param name=&quot;list&quot;&gt;The input list.&lt;/param&gt;<br />&lt;returns&gt;The resulting sum.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs93">val snd : tuple:(&#39;T1 * &#39;T2) -&gt; &#39;T2<br /><em>&lt;summary&gt;Return the second element of a tuple, &lt;c&gt;snd (a,b) = b&lt;/c&gt;.&lt;/summary&gt;<br />&lt;param name=&quot;tuple&quot;&gt;The input tuple.&lt;/param&gt;<br />&lt;returns&gt;The second value.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs94">val mktCap : float</div>
<div class="fsdocs-tip" id="fs95">val giveValueWeights : x:AssignedPortfolio -&gt; Portfolio</div>
<div class="fsdocs-tip" id="fs96">val strategyWeights : Portfolio list</div>
<div class="fsdocs-tip" id="fs97">val returnMap : Map&lt;SecurityId,float&gt;</div>

        </div>

        <!-- BEGIN SEARCH BOX: this adds support for the search box -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
        <script type="text/javascript">var fsdocs_search_baseurl = '/Teaching/';</script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.8/lunr.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.min.js"></script>
        <script type="text/javascript" src="/Teaching/content/fsdocs-search.js"></script>
        <!-- END SEARCH BOX: this adds support for the search box -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    </div>
</body>

</html>